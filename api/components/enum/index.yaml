search:
  context: &context
    $ref: "./context.yaml"
  message:
    intent:
      category: &category
          $ref: './category.yaml'
on_search:
  context: *context
  message:
    catalog:
      providers:
        items: &item
          $ref: "./item.yaml"
        category: *category
select:
  context: *context
  message:
    order: &order
      items: 
        $ref: "./form_status.yaml"
on_select:
  context: *context
  message:
    order: *order
init:
  context: *context
  message:
    order: 
      payment:
        $ref: "./payment.yaml#/collected_by"
      items: 
        $ref: "./form_status.yaml"
on_init:
  context: *context
  message:
    order: &order
      items: *item
      payment: &payment
        $ref: "./payment.yaml"
      fulfillments: &fulfillment
        $ref: "./Fulfillment.yaml"
      cancellation_terms: &cancellation_terms
        $ref: "./cancellation_terms.yaml"
confirm:
  context: *context
  message:
    order:
      items: 
        $ref: "./form_status.yaml"
on_confirm:
  context: *context
  message:
    order: *order
status:
  context: *context
on_status:
  context: *context
  message:
    order: *order
update:
  context: *context
  message:
    order: &order
      payment: &payment
        $ref: "./payment.yaml"
      fulfillments: &fulfillment
        $ref: "./fulfillment.yaml"
on_update:
  context: *context
  message:
    order: *order
