search:
  message: 
    intent:
      category:  
        descriptor: 
            code: &code
              required: mandatory
              description: Physical description of code value for something
              reference: if any
              usage: personal-loan
        # price: &price
        #   $ref: '../price.yaml' 
on_search:
  message:
    catalog:
      descriptor: 
        name: &descriptorName
          $ref: '../descriptor.yaml#/name'
      providers: 
        id: &id
          required: mandatory
          description: Unique human readable ID.
          reference: if any
          usage: df5a0d61-f3f5-46ac-ad1d-21b2b60b18ab
        descriptor: &descriptor
          $ref: '../descriptor.yaml'
        categories:
          id: *id
          descriptor: &descriptorSub
            code: *code
            name: *descriptorName
        items:
          id: *id 
          descriptor: *descriptor
          category_ids:
            required: mandatory
            description: Categories this item can be listed under
            reference: if any
            usage: de409a6e-0a38-473d-a246-fb9ee5f9a48e
          xinput:
            head: 
              descriptor: 
                name: *descriptorName
              index: &inputIndex
                $ref: '../inputIndex.yaml'  
            form:
              id: *id
              $ref: '../forms.yaml'
            # required:
            #   $ref: '../xinput.yaml#/required'
select:
  message:
    order:
      provider:
        id: *id 
        items:
          id: *id 
          xinput:
            form_response:
              $ref: '../form-response.yaml'
on_select:
  message:
    order:
      provider:
        id: *id
        descriptor: *descriptor
      items:
        id: *id
        descriptor: *descriptor
        xinput:
          head: 
            descriptor: 
              name: *descriptorName
            index: *inputIndex
          form:
            $ref: '../forms.yaml'
init: 
  message:
    order:
      provider:
        id: *id 
        items:
          id: *id 
          xinput:
            form_response:
              $ref: '../form-response.yaml'
on_init:
  message:
    order:
      provider:
        id: *id 
        descriptor: *descriptor
      items: 
        id: *id
        descriptor: *descriptor
        price: &price
          $ref: '../price.yaml' 
        xinput:
          form_response:
            $ref: '../form-response.yaml'
      quote: &quote
        id: *id
        # price: *price
        breakup: 
          title:
            required: mandatory
            description: the breakup title of the total quoted price
            reference: if any
            usage: Amount
          # price: *price
      fulfillments: &fullfilments
        customer:
          $ref: '../customer.yaml'
      payments: &payment
        $ref: '../payment.yaml'
      cancellation_terms: &cancellation_terms
        $ref: '../cancellation_terms.yaml' 
confirm:
  message:
    order:
      provider:
        id: *id
      items:
        id: *id
        xinput:
          form_response:
            $ref: '../form-response.yaml'
on_confirm:
  message:
    order:
      id: *id 
      provider:
        id: *id    
        descriptor: *descriptor
      items: 
        id: *id
        descriptor: *descriptor  
        price: *price
      quote: *quote
      fulfillments: *fullfilments
      payments: *payment
      cancellation_terms: *cancellation_terms
status:
  message:
    order_id: *id  
on_status:
  message:
    order:
      id: *id  
      provider:
        id: *id 
        descriptor: *descriptor
        items: 
          id: *id
          descriptor: *descriptorSub
          price: *price
      quote: *quote
      fulfillments: *fullfilments
support:
  message:
    support:
      ref_id: 
        $ref: '../support.yaml#/ref_id'
      phone: 
        $ref: '../support.yaml#/phone'
      email: 
        $ref: '../support.yaml#/email'   
     
on_support:
  message:
    support:
      $ref: '../support.yaml'
